<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="app.css">
</head>

<body>
    <h1>Bandwidth</h1>
    <div id="wrapper">
        <!-- <div class="item priority3">ogdsgakfdfjafjfkd jfkaffjksfjafjkdsfjk sfkasfkasfkaj sdfsdjfhj</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority2">Hello</div>
        <div class="item priority1">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority2">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority2">Hello</div>
        <div class="item priority3">Hello</div>
        <div class="item priority3">Hello</div> -->
    </div>

    <script src="https://unpkg.com/realm-web/dist/bundle.iife.js"></script>
    <script>

        async function myFunction() {
            const APP_ID = "bandwidth-luesr";
            // Add your App ID
            const app = new Realm.App({ id: APP_ID });

            async function loginApiKey(apiKey) {
                // Create an API Key credential
                const credentials = Realm.Credentials.apiKey(apiKey);

                // Authenticate the user
                const user = await app.logIn(credentials);

                // `App.currentUser` updates to match the logged in user
                console.assert(user.id === app.currentUser.id);

                return user;
            }

            const user = await loginApiKey("XBsMMa4h2UzTChxJV4dpuzw86qMFqZyXYrC2wdbWAHVITR4JNoNRwcOzyUathgqm"); // add previously generated API key

            const mongo = app.currentUser.mongoClient("mongodb-atlas");
            const itemsCollection = mongo.db("Bandwidth").collection("Items");

            const items = await itemsCollection.find();
            console.log(items);
            console.log("oogabooga");
            populateList();

            function populateList() {
                var wrapper = document.getElementById("wrapper");
                items.forEach(item => {
                    addItemToList(wrapper, item);
                });
            }

            function addItemToList(wrapper, item) {
                const template = document.createElement('div');
                template.innerHTML = item.text;
                template.classList.add("item");
                switch (item.priority) {
                    case 1:
                        template.classList.add("priority1");
                        break;
                    case 2:
                        template.classList.add("priority2");
                        break;
                    default:
                        template.classList.add("priority3");
                        
                }
                console.log(template.classList);
                wrapper.appendChild(template);
            }
        }
        myFunction();
    </script>
</body>

</html>